(function(a,h,g){function I(){function q(d,b,s,k){this.id=d;this.title=s;this.total_images=b;this.current_image=0;this.image_loaded=[];this.images=[];this.image_links=[];this.image_titles=[];this.thumbs_loaded=!1;this.thumb_strip=a("<div></div>");this.thumb_loaded=[];this.thumbs_src=[];var f=[],e=this;k.each(function(b,k){a(this).attr({"data-albumize-image-id":b,"data-albumize-album-id":d});e.image_links.push(a(this).attr("href"));var c=a(this).attr("title");void 0==s&&(c="");e.image_titles.push(c);
c=a(this).children("img");e.thumbs_src.push(c.attr("src"));"albumize-cover"==c.attr("class")&&f.push(c.attr("src"))});for(k=0;k<b;k++)this.image_loaded[k]=!1;var c=a("<div></div>").addClass("albumize-album-info").attr("data-albumize-album-id",d);k=a("<div></div>").addClass("albumize-album-cover-info");var m=a("<img></img>").attr({"class":"albumize-album-cover-img",src:f[0]}),r=a("<div></div>").addClass("albumize-cover-title").text(s),n=1<b?"images":"image";b=a("<div></div>").addClass("albumize-cover-count").text(b+
" "+n);k.append(r,b);c.append(k);m.load(function(){c.append(m)});K.append(c)}var u=a("#albumize-pane"),B=a("#albumize-olay"),l=a("#albumize-album-overlay"),E=a("#albumize-album-window");a("#albumize-album-window-close");var F=a("#albumize-album-list-button"),b=a("#albumize-i-window"),n=a("#albumize-loading"),v=a("#albumize-loading-error"),H=a("#albumize-album-title-pane"),m=a("#albumize-album-name"),L=a("#albumize-image-title"),c=a("#albumize-prev"),G=a("#albumize-next"),K=a("#albumize-album-pane-body"),
z=a("#albumize-t-body"),p=a(h).height(),t=a(h).width(),r=a(g).height(),A=a(g).width(),C=100*(p/r)+"%",D=100*(t/A)+"%",w=doc.scrollTop(),x=doc.scrollLeft();this.fresh_start=!0;this.current_album=0;var y=[];q.prototype=new function(){this.handle_nav=function(a){G.removeClass("albumize-inactive");c.removeClass("albumize-inactive");if(a==this.total_images-1||0==a)a==this.total_images-1&&G.addClass("albumize-inactive"),0==a&&c.addClass("albumize-inactive"),a==this.total_images-1&&0==a&&(G.addClass("albumize-inactive"),
c.addClass("albumize-inactive"))};this.prev=function(){if(0<this.current_image){var a=parseInt(this.current_image)-1;this.show_image(a,this.image_links[a])}};this.next=function(){if(this.current_image<this.total_images-1){var a=parseInt(this.current_image)+1;this.show_image(a,this.image_links[a])}};this.get_image_link=function(a){return this.image_links[a]};this.show_image=function(d,c){p=a(h).height();t=a(h).width();r=a(g).height();A=a(g).width();C=100*(p/r)+"%";D=100*(t/A)+"%";if(this.image_loaded[d])n.hide(),
l.hide(),this.current_image=d,this.handle_nav(d),b.hide().html(this.images[d]).fadeIn("slow");else{n.show();l.show();var s=this,k,f,e=new Image;e.src=c;e.onerror=function(){b.html("");l.stop(end,end).show();v.html('Error loading image . . . <span id = "albumize-error-dismiss">Dismiss</span>').show();n.show();s.current_image=d;s.handle_nav(d)};e.onload=function(){n.show();l.show();k=500>this.width?this.width:682;f=500>f?this.height:542;var c=100*(k/682),e=100*(f/542),m=(100-e)/2,r=(100-c)/2,p=a(this);
p.css({width:c+"%",height:e+"%",position:"absolute",top:m+"%",left:r+"%"});s.images[d]=a(this);s.image_loaded[d]=!0;s.current_image=d;s.handle_nav(d);b.hide().html(p).fadeIn("slow");w=doc.scrollTop();x=doc.scrollLeft();B.css({width:D,height:C}).fadeIn("slow");u.css({top:w+"px",left:x+"px"}).slideDown("slow");v.is(":visible")||(v.hide(),n.hide(),l.hide())}}L.text(this.image_titles[d])};this.show=function(d){""!=this.title?(m.text(this.title),H.show()):H.hide();if(this.thumbs_loaded)z.html(this.thumb_strip),
void 0==d?(this.show_image(0,this.image_links[0]),E.removeClass("in").fadeOut()):(w=doc.scrollTop(),x=doc.scrollLeft(),B.css({width:D,height:C}).fadeIn("slow"),u.css({top:w+"px",left:x+"px"}).slideDown("slow"),this.show_image(d,this.image_links[d]));else{l.show();n.show();for(var c=0,b=0,k=[],f=this,e=0;e<this.total_images;e++)k[e]=new Image,k[e].src=this.thumbs_src[e],k[e].setAttribute("data-albumize-album-id",this.id),k[e].setAttribute("data-albumize-image-id",e),k[e].onload=function(){this.className=
"albumize-thumb";f.thumb_strip.append(this);++c==f.total_images&&(f.thumb_strip=f.thumb_strip.html(),z.html(f.thumb_strip),0<b&&b!=f.total_images?(v.html('Error loading some thumbnails . . . <span id = "albumize-error-dismiss">Dismiss</span>').fadeIn(),l.delay("7000").stop(end,end).hide(function(){n.hide();v.hide();f.thumbs_loaded=!0})):b==f.total_images?(v.html('Error loading images . . . <span id = "albumize-error-dismiss">Dismiss</span>').fadeIn(),f.thumbs_loaded=!1,f.thumb_strip=0,f.thumb_strip=
a("<div></div>")):0==b&&(f.thumbs_loaded=!0,n.hide(),l.hide()),void 0==d?(f.show_image(0,f.image_links[0]),E.removeClass("in").fadeOut(),n.show(),l.show()):(w=doc.scrollTop(),x=doc.scrollLeft(),B.css({width:D,height:C}).fadeIn("slow"),u.css({top:w+"px",left:x+"px"}).slideDown("slow"),f.show_image(d,f.image_links[d])))},k[e].onerror=function(){b++;this.style.display="none";this.onload()}}}};this.init=function(b,c){c.each(function(b,c){a(this).attr("data-albumize-album-id",b);var d=a(this).attr("title");
void 0==d&&(d="");var e=a(this).children("a");y[b]=new q(b,e.length,d,e)})};this.show=function(a,b){this.fresh_start=!1;this.current_album=a;y[a].get_image_link(b);y[a].show(b)};this.show_album=function(a){this.fresh_start=!1;this.current_album=a;y[a].show()};this.show_image_from_thumb=function(a,b){this.fresh_start=!1;var c=y[a].get_image_link(b);y[a].show_image(b,c)};this.show_albums=function(){p=a(h).height();t=a(h).width();r=a(g).height();A=a(g).width();C=100*(p/r)+"%";D=100*(t/A)+"%";w=doc.scrollTop();
x=doc.scrollLeft();B.css({width:D,height:C}).fadeIn("slow");u.css({top:w+"px",left:x+"px"}).slideDown("slow");F.click()};this.show_next=function(){y[this.current_album].next()};this.show_prev=function(){y[this.current_album].prev()}}win=a(g);doc=a(h);var q;a(h).ready(function(){var J=a(h).height(),u=a(h).width(),B=a(g).height(),l=a(g).width(),E=100*(J/B)+"%",F=100*(u/l)+"%";a(g).scrollTop();a(g).scrollLeft();var b=a(h.body);b.width();b.height();var n=a(".albumize"),v=n.length;(function(){var n=a("<div></div>").addClass("albumize-overlay").attr("id",
"albumize-olay").css({width:F,height:E}),m=a("<div></div>").addClass("albumize-pane").attr("id","albumize-pane"),q=a('<div><div id = "albumize-loading-error"></div><div id = "albumize-loading"></div></div>').addClass("albumize-album-overlay").attr("id","albumize-album-overlay"),c=a("<div></div>").addClass("albumize-header").attr("id","albumize-header"),h=a("<button>&times;</button>").addClass("albumize-close").attr("id","albumize-close"),g=a('<div><span id = "albumize-album-label">Album</span><span id = "albumize-album-name"></span></div>').attr("id",
"albumize-album-title-pane"),l=a("<div></div>").attr("id","albumize-image-title");h.appendTo(c);g.appendTo(c);l.appendTo(c);var h=a("<div></div>").addClass("albumize-control-pane").attr("id","albumize-control-pane"),g=a("<div></div>").addClass("albumize-prev").attr("id","albumize-prev"),l=a("<div></div>").addClass("albumize-album-list").attr("id","albumize-album-list-button"),p=a("<div></div>").addClass("albumize-next").attr("id","albumize-next"),t=a('<div><div class = "albumize-modal-header" id = "albumize-album-pane-header"><button class = "albumize-albums-close" id = "albumize-album-window-close">&times;</button><h3>Albums</h3></div><div class = "albumize-modal-body" id = "albumize-album-pane-body"></div><div class = "albumize-modal-footer" id = "albumize-album-pane-footer">click to view album</div></div>').addClass("albumize-album-window albumize-modal fade").attr("id",
"albumize-album-window"),r=a('<div><div class = "albumize-t-slider" id = "albumize-t-slider"></div><div class = "albumize-t-pane" id = "albumize-t-pane"><div class = "albumize-t-header" id = "albumize-t-header"></div><div class = "albumize-t-body" id = "albumize-t-body"></div></div></div>').addClass("albumize-t-window").attr("id","albumize-t-window"),A=a("<div></div>").addClass("albumize-i-window").attr("id","albumize-i-window");h.append(g,l,p);m.append(c);m.append(A);m.append(h);m.append(r);n.appendTo(b);
m.appendTo(b);m.append(q);m.append(t)})();(function(){q=new I;a.albumize=function(){0==arguments.length&&q.show_albums()};q.init(v,n);var h=a("#albumize-olay"),m=a("#albumize-pane"),g=a("#albumize-album-window"),c=a("#albumize-album-overlay");a("#albumize-album-window-close");var l=a("#albumize-t-slider"),u=a("#albumize-t-window"),z=a("#albumize-loading"),p=a("#albumize-loading-error"),t=!0;b.on("click","#albumize-olay",function(){g.hide();z.hide();p.hide();c.hide();m.slideUp("fast");h.slideUp("fast")});
b.on("click","#albumize-pane #albumize-close",function(){g.hide();z.hide();p.hide();c.hide();m.slideUp("fast");h.fadeOut("fast")});b.on("click","#albumize-album-list-button",function(){g.fadeIn().addClass("in");c.fadeIn()});b.on("click","#albumize-album-window-close",function(){q.fresh_start?(z.hide(),p.hide(),m.hide(),g.removeClass("in").fadeOut(),c.fadeOut("fast"),h.fadeOut("fast")):(g.removeClass("in").fadeOut(),c.fadeOut())});b.on("click","#albumize-t-slider",function(){(t=!t)?l.removeClass("out"):
l.addClass("out");u.toggleClass("t-hide")});b.on("click",".albumize a",function(){var b=parseInt(a(this).attr("data-albumize-album-id")),c=parseInt(a(this).attr("data-albumize-image-id"));q.show(b,c);return!1});b.on("click",".albumize-album-info",function(){var b=parseInt(a(this).attr("data-albumize-album-id"));q.show_album(b)});b.on("click","#albumize-error-dismiss",function(){c.stop().fadeOut();z.hide();p.hide()});b.on("click",".albumize-thumb",function(){var b=parseInt(a(this).attr("data-albumize-album-id")),
c=parseInt(a(this).attr("data-albumize-image-id"));q.show_image_from_thumb(b,c)});b.on("click","#albumize-prev",function(){q.show_prev()});b.on("click","#albumize-next",function(){q.show_next()})})()})})(jQuery,document,window);